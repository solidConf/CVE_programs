/*
Commit Number: 54cf8b01
URL: https://gitlab.com/wireshark/wireshark/-/issues/17754
Project Name: Wireshark
termination: FALSE
*/
typedef unsigned int guint;
typedef unsigned char guint8;
#define NULL 0
typedef struct _proto_node {
    struct _proto_node *first_child;
    struct _proto_node *last_child;
    struct _proto_node *next;
    struct _proto_node *parent;
    field_info         *finfo;
    tree_data_t        *tree_data;
} proto_node;
typedef proto_node proto_item;

struct tvbuff{
    unsigned char *real_data;
    unsigned int	length;
};
//struct tvbuff;
typedef struct tvbuff tvbuff_t;


gint
tvb_reported_length_remaining(const tvbuff_t *tvb, const gint offset)
{
    guint abs_offset = 0;
    int   exception;

    DISSECTOR_ASSERT(tvb && tvb->initialized);

    exception = compute_offset(tvb, offset, &abs_offset);
    if (exception)
        return 0;

    if (tvb->reported_length >= abs_offset)
        return tvb->reported_length - abs_offset;
    else
        return 0;
}
static int
dissect_bt_dht_values(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint offset, const char **result, const char *label ) {

    expert_add_info(pinfo, ti, &ei_invalid_len);
    // Fail hard here rather than potentially looping excessively.
    return tvb_reported_length_remaining(tvb, offset);

}
static int
dissect_bencoded_dict_entry(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint offset )
{
    offset   = dissect_bencoded_string( tvb, pinfo, sub_tree, offset, &key, FALSE, "Key" );
    if (offset == 0)
    {
        return 0;
    }
    offset = dissect_bencoded_dict( tvb, pinfo, sub_tree, offset, "Value" );
    offset = dissect_bencoded_string( tvb, pinfo, sub_tree, old_offset, &val, TRUE, "Value" );
    if (offset == 0)
        return 0
}

int main(){
        while( tvb_get_guint8(tvb,offset)!='e' ) {
        offset = dissect_bencoded_dict_entry( tvb, pinfo, sub_tree, offset );
        if (offset == 0)
        {
            return 0;
        }
    }

}