/*
Commit Number: v3.6.0-0-g3a34e44d02c9
URL: https://gitlab.com/wireshark/wireshark/-/issues/17745
Project Name: Wireshark
termination: FALSE
*/
typedef signed char gint8;
typedef unsigned char guint8;
typedef signed int gint32;
typedef unsigned int guint32;
typedef unsigned int guint;
typedef int    gint;
typedef unsigned long gulong;
#define GPOINTER_TO_INT(p)	((gint)  (glong) (p))
#define GPOINTER_TO_UINT(p)	((guint) (gulong) (p))

#define GINT_TO_POINTER(i)	((gpointer) (glong) (i))
#define GUINT_TO_POINTER(u)	((gpointer) (gulong) (u))
#define NULL 0

typedef struct rtmpt_packet {
    guint32          seq;
    guint32          lastseq;

    int              resident;
    union {
        guint8  *p;
        guint32  offset;
    } data;

    /* used during unchunking */
    int              want;
    int              have;
    int              chunkwant;
    int              chunkhave;

    guint8           bhlen;
    guint8           mhlen;

    /* Chunk Basic Header */
    guint8           fmt;   /* byte 0 */
    guint32          id;    /* byte 0 */

    /* Chunk Message Header (offsets assume bhlen == 1) */
    guint32          ts;    /* bytes 1-3, or from ETS @ mhlen-4 if -1 */
    guint32          len;   /* bytes 4-6 */
    guint8           cmd;   /* byte 7 */
    guint32          src;   /* bytes 8-11 */

    guint32          txid;
    gint             isresponse;
    gint             otherframe;

} rtmpt_packet_t;

struct _wmem_tree_node_t {
    struct _wmem_tree_node_t *parent;
    struct _wmem_tree_node_t *left;
    struct _wmem_tree_node_t *right;
    const void *key;
    void *data;

};
typedef struct _wmem_tree_node_t wmem_tree_node_t;
struct _wmem_tree_t {
    wmem_tree_node_t *root;
};
typedef struct _wmem_tree_t wmem_tree_t;



void *
wmem_tree_lookup32_le(wmem_tree_t *tree, guint32 key)
{
    wmem_tree_node_t *node = tree->root;

    while (node) {
        if (key == GPOINTER_TO_UINT(node->key)) {
            return node->data;
        }
        else if (key < GPOINTER_TO_UINT(node->key)) {
            if (node->left == NULL) {
                break;
            }
            node = node->left;
        }
        else if (key > GPOINTER_TO_UINT(node->key)) {
            if (node->right == NULL) {
                break;
            }
            node = node->right;
        }
    }

    if (!node) {
        return NULL;
    }
    if (node->parent == NULL) {
        if (key > GPOINTER_TO_UINT(node->key)) {
            return node->data;
        } else {
            return NULL;
        }
    }

    if (GPOINTER_TO_UINT(node->key) <= key) {
        return node->data;
    }
    else if (node == node->parent->left) {
        while (node) {
            if (key > GPOINTER_TO_UINT(node->key)) {
                return node->data;
            }
            node=node->parent;
        }
        return NULL;
    }
    else {
        return node->parent->data;
    }
}
int main(){
    wmem_tree_t* cdir;
    cdir = (wmem_tree_t*) malloc(sizeof(wmem_tree_t));
    cdir->root = (wmem_tree_node_t*) malloc(sizeof(wmem_tree_node_t));
    rtmpt_packet_t* tp = (rtmpt_packet_t*) malloc(sizeof (rtmpt_packet_t));
    tp->seq = __VERIFIER_nondet_unsigned_int();
    cdir->root = tp;
    unsigned int seq = 0;
    while (tp && tp->lastseq >= seq) {
        if (tp->seq == 0) {
            break;
        }
        tp = (rtmpt_packet_t *) wmem_tree_lookup32_le(cdir, tp->seq-1);
    }
}
